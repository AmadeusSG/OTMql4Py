<!DOCTYPE html>
<html>
<!-- This file is automatically generated: do not edit. -->
<head>
<title>OTLib Py27</title>
<meta charset="utf-8">
</head>
<body>
<!-- <h1>OTLib Py27</h1> -->
<h3>MQL4/Libraries/OTMql4/OTLibPy27.mq4</h3>

<p>This will provide our logging functions that work with Python.<br />
See OTLibLog for just a skeleton logging.<br />
We introduce a global variable fDebugLevel which ranges from 0 to 5:<br />
"PANIC", "ERROR", "WARNING", "INFO", "DEBUG", "TRACE"<br />
If you set the variable to 1, you will only see errors; if you set<br />
it to 2 you will see warnings and errors...<br />
The Mt4 code can use vLog(iLevel, uMsg) to log accordingly.<br />
The Python code can use vLog(iLevel, sMsg) to log accordingly.<br />
Wrappers around the imported funtions for strings:<br />
they expect uchar[] arrays, not unicode strings.</p>

<p><tt>void vPyExecuteUnicode (string uSource) </tt></p>

<p><tt>int iPyEvaluateUnicode (string uSource) </tt></p>

<p><tt>int iPyNewStringUnicode(string &amp;uSource) </tt></p>

<p><tt>int iPyLookupDictUnicode(int p_dict, string uName) </tt><br />
Below are some higher level abstractions, here you dont have to<br />
care about reference counting when using the functions, you will<br />
not be exposed to handles of python objects.</p>

<p><tt>int iPyInit(string sStdOut) </tt><br />
    Initializes the Python environment. This should be called<br />
    from your OnInit() function. It is safe to call it a second time;<br />
    subsequent calls will just be ignored.<br />
    It should return 0.<br />
    A return value of -1 is a panic: remove the expert if it requires Python.</p>

<p><tt>void vPyOutEmpty() </tt><br />
    empty the stdout file (where the redirected print output and errors go)</p>

<p><tt>void vPyPrintAndClearLastError() </tt><br />
    You MUST do something to clear any error condition<br />
    or the system will crash, as documented in the Python manual.</p>

<p><tt>string ePySafeExec(string uSource) </tt><br />
    Evaluate a python expression has no return value<br />
    and return any errors as a string, otherwise return ""<br />
    In the caller you should have something like:<br />
    {{{<br />
    if (StringCompare(uRetval, "") != 0) {<br />
    Print("Error in Python execing: " + uSource + "\n" + res);<br />
    &lt;do something as a result of the failure&gt;<br />
    }<br />
    }}}</p>

<p><tt>string uPySafeEval(string uSource) </tt><br />
    Evaluate a python expression that will evaluate to a string<br />
    and return its value<br />
    In the caller you should have something like:<br />
    {{{<br />
    if (StringFind(uRetval, "ERROR:", 0) == 0) {<br />
    Print("Error in Python evaluating: " + uSource + "\n" + res);<br />
    &lt;do something as a result of the failure&gt;<br />
    }<br />
    }}}</p>

<p><tt>void vPanic(string uReason) </tt><br />
    A panic prints an error message and then aborts</p>

<p><tt>int iPySafeExec(string uArg) </tt></p>

<p><tt>int iPyEvalInt(string uSource) </tt><br />
    Evaluate a python expression that will evaluate to an integer<br />
    and return its value</p>

<p><tt>double fPyEvalDouble(string uSource) </tt><br />
    Evaluate a python expression that will evaluate to a double<br />
    and return its value</p>

<p><tt>string uPyEvalUnicode(string uSource) </tt></p>

<p><tt>int iPyListAppendInt(string list_name, int &amp;array[]) </tt><br />
    append the array of int to the python list given by its name.<br />
    the list must already exist. The same could be achieved<br />
    by putting vPyExecuteUnicode() calls with generated python code<br />
    into a loop but this would invoke parser and compiler for<br />
    every new list item, directly accessing the python objects<br />
    like it is done here is far more effective.</p>

<p><tt>int iPyListAppendDouble(string list_name, double &amp;array[]) </tt><br />
    append the array of double to the python list given by its name.<br />
    the list must already exist.</p>

<p><tt>int iPyListAppendString(string list_name, string &amp;array[]) </tt><br />
    Append the array of string to the python list given by its name.<br />
    the list must already exist.</p>

<p><tt>void vPyDeInit() </tt></p>

<p><tt>string uChartName(string uSymbol, int iPeriod, long iWindowId, int iExtra=0) </tt><br />
    We will need a unique identifier for each chart</p>

<p>Source code: <a href="MQL4/Libraries/OTMql4/OTLibPy27.mq4">https://github.com/OpenTrading/OTMql4Py/raw/master/MQL4/Libraries/OTMql4/OTLibPy27.mq4</a></p>

<p>This file is automatically generated from the source code: do not edit.</p>
<hr />

<p>Parent: <a href="CodeLibraries.html">CodeLibraries</a></p></body>
</html>
